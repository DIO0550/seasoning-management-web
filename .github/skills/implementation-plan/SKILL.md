---
name: implementation-plan
description: 機能実装設計スキル。特定機能の実装設計書を作成する。「実装設計を書きたい」「コンポーネント設計をしたい」「移行計画を立てたい」などのリクエスト時に使用。フォルダ構造、コンポーネント設計、実装状態、移行計画を含む技術的な実装仕様書を生成。
---

# Implementation Plan 作成

特定機能の実装設計書を作成するスキル。

## ⚠️ 重要: システム図は必須

このスキルで生成する実装設計書には**必ずシステム図（状態マシン図 + データフロー図）を含めること**。
システム図がない実装設計書は不完全であり、生成完了とみなさない。

## ワークフロー

```
1. 機能名・目的のヒアリング
   ↓
2. 設計方針の確認
   ↓
3. テンプレートに沿って実装設計書を生成
   ↓
4. ユーザー確認・修正
```

## Step 1: ヒアリング

### 必須項目

**基本情報**
- 機能名
- 設計方針（採用するアーキテクチャパターン、選定理由）

**構造**
- 現在のフォルダ構造
- 将来的なフォルダ構造

**コンポーネント設計**
- 主要コンポーネント（型定義、ファクトリ、ユーティリティ）
- データフロー
- エラーハンドリング方針

**実装状態**
- 実装済みタスク
- 未実装タスク

**移行計画**
- フェーズ分け
- 各フェーズの成果物

## Step 2: 実装設計書生成

ヒアリング結果を元に `.specs/{feature-name}/implementation-plan.md` を生成。

テンプレート: `assets/templates/implementation-plan-template.md`

### Step 2-1: 各セクションを執筆

1. 設計方針
2. **システム図**（状態マシン図 + データフロー図）
3. フォルダ構造（現在・将来）
4. 主要コンポーネントの設計（型定義、実装コード例）
5. 利点
6. 使用例
7. 実装状態（実装済み・未実装）
8. 移行計画（Phase分け）
9. 技術的な詳細（エラーハンドリング、パフォーマンス）

### Step 2-2: システム図を作成

状態マシン図とデータフロー図を**必ず**作成する。これにより：
- すべてのパス・分岐・エッジケースを可視化
- 実装の抜け漏れを防止
- システムレベルでの正しさを検証可能

```
ASCII図の例:

    入力
      │
      ▼
┌─────────────┐
│  STATE_A    │─── 条件1 ───▶ STATE_B
└─────────────┘                  │
      │                          │
   条件2                      条件3
      │                          │
      ▼                          ▼
┌─────────────┐           ┌─────────────┐
│  STATE_C    │           │  STATE_D    │
└─────────────┘           └─────────────┘
```

図に含めるべき要素：
- **状態（State）**: 各状態を明確に命名
- **遷移条件**: 何がトリガーで状態が変わるか
- **分岐**: すべての条件分岐を網羅
- **エッジケース**: エラー時・タイムアウト時の遷移
- **ループ**: 繰り返し処理がある場合

### Step 2-3: 完了チェックリスト

実装設計書生成後、以下を確認すること：

- [ ] 状態マシン図が含まれているか
- [ ] データフロー図が含まれているか
- [ ] 図にすべての状態・遷移条件・エッジケースが含まれているか
- [ ] 図と各セクションの内容が整合しているか

**チェックリストを満たさない場合、生成完了とみなさない。**

### コード例の書き方

プロジェクトの使用言語に合わせてコード例を記述する。

```
// src/feature/models/component-a.{ext}

// 型定義（言語に応じた形式）

// ファクトリ/生成関数

// ユーティリティ関数
```

## Step 3: ユーザー確認

生成した実装設計書をユーザーに提示:

1. 設計方針のサマリー
2. 主要コンポーネント一覧
3. 移行計画の概要
4. 「修正が必要な場合はお知らせください」

## 出力

```
.specs/
└── {feature-name}/
    └── implementation-plan.md
```

`{feature-name}` はケバブケースで命名。
